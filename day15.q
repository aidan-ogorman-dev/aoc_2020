/ part 1
last {[x] $[not last[x] in distinct -1 _ x; :x,0; last[x] = last prev x; x,1; x,(-/)reverse -2#group[x] last x]}/[2014;2 0 6 12 1 3]
